(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[269],{8855:function(){},6486:function(e,t,r){Promise.resolve().then(r.bind(r,5886))},5886:function(e,t,r){"use strict";r.r(t),r.d(t,{FeedItemPage:function(){return Q}});var a,n,s=r(8754),i={src:"/s-wave/_next/static/media/audio-next.82c34ac1.svg",height:64,width:64,blurWidth:0,blurHeight:0},l={src:"/s-wave/_next/static/media/audio-previous.76380240.svg",height:64,width:64,blurWidth:0,blurHeight:0},o={src:"/s-wave/_next/static/media/audio-play.e9dc8c39.svg",height:800,width:800,blurWidth:0,blurHeight:0},c={src:"/s-wave/_next/static/media/audio-pause.08db4f88.svg",height:64,width:64,blurWidth:0,blurHeight:0},d=r(8661),u=r(2123),m=r(1986);function g(e){let{feedItem:t}=e,r=(0,u.useRef)(null),[a,n]=(0,u.useState)(!1),[g,x]=(0,u.useState)(0),[f,h]=(0,u.useState)(0),b=()=>{r.current&&(a?r.current.pause():r.current.play(),n(!a))},p=()=>{r.current&&(r.current.currentTime-=.1*f)},v=()=>{r.current&&(r.current.currentTime+=.1*f)};return(0,s.jsxs)("div",{className:"flex-none flex-grow-0 bg-white p-8 rounded-lg shadow-md w-80",children:[(0,s.jsx)("audio",{ref:r,src:t.enclosure.url,onLoadedMetadata:()=>{r.current&&h(r.current.duration)},onTimeUpdate:()=>{r.current&&x(r.current.currentTime)},className:"hidden"}),(0,s.jsx)("img",{src:t.itunes.image,alt:t.title,className:"w-64 h-64 mx-auto rounded-lg mb-4 shadow-lg shadow-pink-50"}),(0,s.jsx)("h2",{className:"text-xl font-semibold text-center",children:t.title}),(0,s.jsx)("p",{className:"text-gray-600 text-sm text-center",children:t.creator?"@".concat(t.creator):""}),(0,s.jsxs)("div",{className:"mt-6 flex justify-center items-center",children:[(0,s.jsx)("button",{className:"p-3 rounded-full bg-gray-200 hover:bg-gray-300 focus:outline-none",onClick:()=>p(),children:(0,s.jsx)(d.default,{src:l,alt:"Previous",width:25,height:25,className:"m-1"})}),(0,s.jsx)("button",{className:"p-4 rounded-full bg-gray-200 hover:bg-gray-300 focus:outline-none mx-4",onClick:()=>b(),children:a?(0,s.jsx)(d.default,{src:c,alt:"Pause",width:35,height:35,className:"m-1"}):(0,s.jsx)(d.default,{src:o,alt:"Pause",width:35,height:35,className:"m-1"})}),(0,s.jsx)("button",{className:"p-3 rounded-full bg-gray-200 hover:bg-gray-300 focus:outline-none",onClick:()=>v(),children:(0,s.jsx)(d.default,{src:i,alt:"Next",width:25,height:25,className:"m-1"})})]}),(0,s.jsx)("div",{className:"mt-6 bg-gray-200 h-2 rounded-full cursor-pointer overflow-hidden",onClick:e=>{if(r.current){let t=(e.clientX-e.target.getBoundingClientRect().left)/e.target.clientWidth*f;r.current.currentTime=t,x(t)}},children:(0,s.jsx)("div",{className:"bg-pink-500 h-2 rounded-full",style:{width:"".concat(g/f*100,"%")}})}),(0,s.jsxs)("div",{className:"flex justify-between mt-2 text-sm text-gray-600",children:[(0,s.jsx)("span",{children:(0,m.le)(g)}),(0,s.jsx)("span",{children:(0,m.le)(f-g)})]})]})}var x=r(168);let f=x.fC,h=u.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(x.aV,{ref:t,className:(0,m.cn)("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",r),...a})});h.displayName=x.aV.displayName;let b=u.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(x.xz,{ref:t,className:(0,m.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow","disabled:pointer-events-none disabled:opacity-50",r),...a})});b.displayName=x.xz.displayName;let p=u.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(x.VY,{ref:t,className:(0,m.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r),...a})});function v(e){let{feedItem:t,fontSize:r}=e;return(0,s.jsxs)("div",{className:"h-full flex flex-col overflow-hidden",children:[(0,s.jsx)("h3",{className:(0,m.cn)("flex-none font-bold mb-2","text-gray-900 leading-[1.4em]"),style:{fontSize:1.5*r},children:t.title}),(0,s.jsx)("div",{className:(0,m.cn)("flex flex-col gap-2 overflow-auto h-full","scrollbar scrollbar-thumb-gray-200 scrollbar-track-transparent","text-gray-700 leading-[1.4em]"),style:{fontSize:r},dangerouslySetInnerHTML:{__html:t.itunes.summary}})]})}p.displayName=x.VY.displayName;var y=r(8456);function w(e){let{transcribedData:t,transcriber:r}=e,a=(0,u.useRef)(null),n=(e,t)=>{let r=URL.createObjectURL(e),a=document.createElement("a");a.href=r,a.download=t,a.click(),URL.revokeObjectURL(r)};return(0,u.useEffect)(()=>{a.current&&64>=Math.abs(a.current.offsetHeight+a.current.scrollTop-a.current.scrollHeight)&&(a.current.scrollTop=a.current.scrollHeight)}),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{ref:a,className:(0,m.cn)("w-full flex flex-col mt-2 overflow-y-auto relative flex-grow h-full","scrollbar scrollbar-thumb-gray-200 scrollbar-track-transparent"),children:(null==t?void 0:t.chunks)&&t.chunks.map((e,t)=>(0,s.jsxs)("div",{className:"w-full flex flex-row mb-1 rounded-lg px-4 py-2 border text-sm",children:[(0,s.jsx)("div",{className:"mr-4",children:(0,y.l)(e.timestamp[0])}),e.text]},"".concat(t,"-").concat(e.text)))}),(0,s.jsxs)("div",{className:"w-full absolute bottom-0 flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>r.resetWorker(),className:(0,m.cn)("text-pink-500 bg-pink-100 hover:bg-pink-200 focus:ring-4 focus:ring-pink-300","font-medium rounded-lg text-xs px-2 py-1 text-center inline-flex items-center",t&&t.isBusy?void 0:"hidden"),children:"停止操作"}),(0,s.jsx)("button",{onClick:()=>{var e;let r=(null!==(e=null==t?void 0:t.chunks)&&void 0!==e?e:[]).map(e=>e.text).join("").trim();n(new Blob([r],{type:"text/plain"}),"transcript.txt")},className:(0,m.cn)("text-pink-500 bg-pink-100 hover:bg-pink-200 focus:ring-4 focus:ring-pink-300","font-medium rounded-lg text-xs px-2 py-1 text-center inline-flex items-center",t?void 0:"hidden"),children:"导出为 TXT"}),(0,s.jsx)("button",{onClick:()=>{var e;let r=JSON.stringify(null!==(e=null==t?void 0:t.chunks)&&void 0!==e?e:[],null,2);r=r.replace(/(    "timestamp": )\[\s+(\S+)\s+(\S+)\s+\]/gm,"$1[$2 $3]"),n(new Blob([r],{type:"application/json"}),"transcript.json")},className:(0,m.cn)("text-pink-500 bg-pink-100 hover:bg-pink-200 focus:ring-4 focus:ring-pink-300","font-medium rounded-lg text-xs px-2 py-1 text-center inline-flex items-center",t?void 0:"hidden"),children:"导出为 JSON"})]})]})}var k=r(7586),j=r(8312),N=r(6081);function C(e){let{isModelLoading:t,isTranscribing:r,isAudioLoading:a,onClick:n,...i}=e;return(0,s.jsx)("button",{className:(0,m.cn)("text-white bg-pink-500 rounded-lg text-xs px-2 py-2 font-medium","flex flex-row items-center justify-center gap-1","hover:bg-pink-600","transition-all duration-300"),onClick:e=>{!n||r||t||n(e)},disabled:r,...i,children:a?(0,s.jsx)(j.$,{text:"正在加载音频 ..."}):t?(0,s.jsx)(j.$,{text:"正在加载模型 ..."}):r?(0,s.jsx)(j.$,{text:"正在听译 ..."}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(N.Z,{strokeWidth:2,size:16}),(0,s.jsx)("span",{children:"开始 AI 听译"})]})})}function L(e){let{text:t,percentage:r}=e;return r=null!=r?r:0,(0,s.jsx)("div",{className:"mt-0.5 w-full relative text-sm text-white background-bg-cyan-400 bg-gray-200 border-1 border-gray-400 rounded-full text-left overflow-hidden",children:(0,s.jsxs)("div",{className:"top-0 h-full bg-pink-500 whitespace-nowrap px-4 text-xs py-1",style:{width:"".concat(r,"%")},children:[t," (","".concat(r.toFixed(2),"%"),")"]})})}function T(){let e=function(){var e;if("undefined"==typeof navigator)return!1;let t=!1;return e=navigator.userAgent||navigator.vendor||("opera"in window&&"string"==typeof window.opera?window.opera:""),(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t}();return{SAMPLING_RATE:16e3,DEFAULT_AUDIO_URL:"https://huggingface.co/datasets/Xenova/transformers.js-docs/resolve/main/".concat(e?"jfk":"ted_60_16k",".wav"),DEFAULT_MODEL:"Xenova/whisper-tiny",DEFAULT_SUBTASK:"transcribe",DEFAULT_LANGUAGE:"zh",DEFAULT_QUANTIZED:!e,DEFAULT_MULTILINGUAL:!0}}(a=n||(n={})).URL="URL",a.FILE="FILE",a.RECORDING="RECORDING";var U=r(361);let S=(0,r(8619).j)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function F(e){let{className:t,variant:r,...a}=e;return(0,s.jsx)("div",{className:(0,m.cn)(S({variant:r}),t),...a})}function A(e){let{transcriber:t}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(F,{variant:"secondary",children:t.subtask}),(0,s.jsx)(F,{variant:"secondary",children:t.model}),t.multilingual&&(0,s.jsx)(F,{variant:"secondary",children:"multilingual"}),(0,s.jsx)(F,{variant:"secondary",children:t.language}),t.quantized&&(0,s.jsx)(F,{variant:"secondary",children:"quantized"})]})}var _=r(3894),E=r.n(_),z=r(2239);function D(e){let{transcriber:t,audioUrl:r}=e,{SAMPLING_RATE:a}=(0,u.useMemo)(()=>T(),[]),[i,l]=(0,u.useState)(void 0),[o,c]=(0,u.useState)(void 0),[d,m]=(0,u.useState)(void 0),g=void 0!==i,x=async(e,t)=>{let r=new AudioContext({sampleRate:a}),s=URL.createObjectURL(new Blob([e],{type:"audio/*"}));c({buffer:await r.decodeAudioData(e),url:s,source:n.URL,mimeType:t})},f=async e=>{if(r)try{c(void 0),l(0);let t=await (0,z.b)(r),a="AUDIO_CACHE_".concat(t),n=await E().getItem(a),s=(0,U.X)(r);if(n){let{data:e,mimeType:t}=n;console.log("audio loaded  from cache: ".concat(a)),await x(e,t)}else{let{data:t,headers:n}=await k.Z.get(s,{signal:e.signal,responseType:"arraybuffer",onDownloadProgress(e){l(e.progress||0)}}),i=n["content-type"];i&&"audio/wave"!==i||(i="audio/wav"),await E().setItem(a,{audioUrl:r,data:t,mimeType:i}),await x(t,i)}}catch(e){console.log("Request failed or aborted",e)}finally{l(void 0)}};return(0,s.jsxs)("div",{className:"flex flex-col justify-start w-full",children:[(0,s.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,s.jsx)(C,{onClick:async()=>{let e=new AbortController;m(e),await f(e),o&&t.start(o.buffer)},isAudioLoading:g,isModelLoading:t.isModelLoading,isTranscribing:t.isBusy}),(0,s.jsx)(A,{transcriber:t})]}),g&&(0,s.jsxs)("div",{className:"flex my-3 gap-2",children:[(0,s.jsx)(L,{text:"正在加载音频...",percentage:100*i}),(0,s.jsx)("button",{className:"flex-none bg-gray-100 text-gray-500 text-xs rounded-xl px-2 py-1",onClick:()=>{null==d||d.abort(),m(void 0)},children:"取消"})]}),o&&t.progressItems.length>0&&(0,s.jsxs)("div",{className:"relative z-10 p-4 w-full",children:[(0,s.jsx)("label",{className:"text-sm text-gray-500",children:"正在加载模型文件... (只运行一次)"}),t.progressItems.map(e=>(0,s.jsx)("div",{children:(0,s.jsx)(L,{text:e.file,percentage:e.progress})},e.file))]})]})}function I(e){let{feedItem:t,transcriber:r}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(D,{transcriber:r,audioUrl:t.enclosure.url}),(0,s.jsx)(w,{transcriber:r,transcribedData:r.output})]})}function R(e){let t=new Worker(r.tu(new URL(r.p+r.u(850),r.b)),{type:void 0});return t.addEventListener("message",e),t}var M=r(1564),O=r(5291),q=r(257);function W(e){let{show:t,onClose:r,onSubmit:a,title:n,content:i,submitText:l,submitEnabled:o=!0}=e;return(0,s.jsx)(O.u,{appear:!0,show:t,as:u.Fragment,children:(0,s.jsxs)(q.V,{as:"div",className:"relative z-10",onClose:r,children:[(0,s.jsx)(O.u.Child,{as:u.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),(0,s.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,s.jsx)("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:(0,s.jsx)(O.u.Child,{as:u.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,s.jsxs)(q.V.Panel,{className:"w-full max-w-md transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl transition-all",children:[(0,s.jsx)(q.V.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900",children:n}),(0,s.jsx)("div",{className:"mt-3 text-sm text-gray-500",children:i}),(0,s.jsxs)("div",{className:"mt-4 flex flex-row-reverse",children:[l&&(0,s.jsx)("button",{type:"button",disabled:!o,className:(0,m.cn)("inline-flex ml-4 justify-center rounded-md border border-transparent","px-4 py-2 text-sm font-medium text-pink-100",o?"bg-pink-600":"bg-pink-300 text-white",o?"hover:bg-pink-500 focus:outline-none focus-visible:ring-2 focus-visible:ring-pink-500 focus-visible:ring-offset-2":"","transition-all duration-300"),onClick:a,children:l}),(0,s.jsx)("button",{type:"button",className:(0,m.cn)("inline-flex justify-center rounded-md border border-transparent bg-gray-100 px-4 py-2 text-sm font-medium text-gray-900","hover:bg-gray-200","focus:outline-none focus-visible:ring-2 focus-visible:ring-gray-500 focus-visible:ring-offset-2","transition-all duration-300"),onClick:r,children:"关闭"})]})]})})})})]})})}function V(e){let t=Object.values(M.a2).map(m.Qs),r={"Xenova/whisper-tiny":[41,152],"Xenova/whisper-base":[77,291],"Xenova/whisper-small":[249],"Xenova/whisper-medium":[776],"distil-whisper/distil-medium.en":[402],"distil-whisper/distil-large-v2":[767]};return(0,s.jsx)(W,{show:e.show,title:"模型设置",content:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("label",{children:"选择使用的模型:"}),(0,s.jsx)("select",{className:(0,m.cn)("mt-1 mb-1 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg  block w-full p-2.5","focus:ring-pink-500 focus:border-pink-500 focus-visible:ring-pink-500 outline-none","dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-pink-500 dark:focus:border-pink-500"),defaultValue:e.transcriber.model,onChange:t=>{e.transcriber.setModel(t.target.value)},children:Object.keys(r).filter(t=>e.transcriber.quantized||2==r[t].length).filter(t=>!e.transcriber.multilingual||!t.startsWith("distil-whisper/")).map(t=>(0,s.jsx)("option",{value:t,children:"".concat(t).concat(e.transcriber.multilingual||t.startsWith("distil-whisper/")?"":".en"," (").concat(r[t][e.transcriber.quantized?0:1],"MB)")},t))}),(0,s.jsxs)("div",{className:"flex justify-between items-center mb-3 px-1",children:[(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("input",{id:"multilingual",type:"checkbox",checked:e.transcriber.multilingual,onChange:t=>{e.transcriber.setMultilingual(t.target.checked)},className:"accent-pink-500"}),(0,s.jsx)("label",{htmlFor:"multilingual",className:"ms-1",children:"多语言"})]}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("input",{id:"quantize",type:"checkbox",checked:e.transcriber.quantized,onChange:t=>{e.transcriber.setQuantized(t.target.checked)},className:"accent-pink-500"}),(0,s.jsx)("label",{htmlFor:"quantize",className:"ms-1",children:"开启量化"})]})]}),e.transcriber.multilingual&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("label",{children:"选择音频语言"}),(0,s.jsx)("select",{className:(0,m.cn)("mt-1 mb-3 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg  block w-full p-2.5","focus:ring-pink-500 focus:border-pink-500 outline-none","dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-pink-500 dark:focus:border-pink-500"),defaultValue:e.transcriber.language,onChange:t=>{e.transcriber.setLanguage(t.target.value)},children:Object.keys(M.a2).map((e,r)=>(0,s.jsx)("option",{value:e,children:t[r]},e))}),(0,s.jsx)("label",{children:"选择执行的任务"}),(0,s.jsxs)("select",{className:(0,m.cn)("mt-1 mb-3 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg  block w-full p-2.5  dark:text-white","focus:ring-pink-500 focus:border-pink-500 outline-none","dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:focus:ring-pink-500 dark:focus:border-pink-500"),defaultValue:e.transcriber.subtask,onChange:t=>{e.transcriber.setSubtask(t.target.value)},children:[(0,s.jsx)("option",{value:"transcribe",children:"听译"}),(0,s.jsxs)("option",{value:"translate",children:["翻译 ","->"," 英语"]})]})]})]}),onClose:e.onClose,onSubmit:()=>{}})}var B=r(1809);function G(e){let[t,r]=(0,u.useState)(!1),a=()=>{r(!1)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{className:(0,m.cn)("flex items-center gap-1 px-2 py-2 rounded-lg","text-gray-500 bg-gray-100/50 hover:bg-gray-100"),onClick:()=>{r(!0)},children:[(0,s.jsx)(B.UG6,{}),(0,s.jsx)("span",{className:"text-sm",children:"模型设置"})]}),(0,s.jsx)(V,{show:t,onSubmit:e=>{a()},onClose:a,transcriber:e.transcriber})]})}var P=r(5396),H=r(1610);function X(e){let{value:t,onChange:r}=e;return(0,s.jsxs)("div",{className:"flex bg-gray-100 p-1 rounded-lg",children:[(0,s.jsx)("button",{className:"hover:bg-white rounded-lg px-1 hover:shadow",onClick:()=>null==r?void 0:r(1.1*t),children:(0,s.jsx)(P.Z,{strokeWidth:1.5})}),(0,s.jsx)("button",{className:"hover:bg-white rounded-lg px-1 hover:shadow",onClick:()=>null==r?void 0:r(.9*t),children:(0,s.jsx)(H.Z,{strokeWidth:1.5})})]})}var Z=r(6847),$=r(4587);function Q(){let e=(0,$.useSearchParams)().get("guid")||"",{doc:t,loading:r}=(0,Z.kh)(e),a=function(){let e=(0,u.useMemo)(()=>T(),[]),[t,r]=(0,u.useState)(void 0),[a,n]=(0,u.useState)(!1),[s,i]=(0,u.useState)(!1),[l,o]=(0,u.useState)([]),{worker:c,resetWorker:d}=function(e){let[t,r]=(0,u.useState)(R(e));return{worker:t,setWorker:r,resetWorker:()=>{null==t||t.terminate(),r(R(e))}}}(e=>{let t=e.data;switch(t.status){case"progress":o(e=>e.map(e=>e.file===t.file?{...e,progress:t.progress}:e));break;case"update":r({isBusy:!0,text:t.data[0],chunks:t.data[1].chunks});break;case"complete":r({isBusy:!1,text:t.data.text,chunks:t.data.chunks}),n(!1);break;case"initiate":i(!0),o(e=>[...e,t]);break;case"ready":i(!1);break;case"error":n(!1),alert("".concat(t.data.message," This is most likely because you are using Safari on an M1/M2 Mac. Please try again from Chrome, Firefox, or Edge.\n\nIf this is not the case, please file a bug report."));break;case"done":o(e=>e.filter(e=>e.file!==t.file))}}),[m,g]=(0,u.useState)(e.DEFAULT_MODEL),[x,f]=(0,u.useState)(e.DEFAULT_SUBTASK),[h,b]=(0,u.useState)(e.DEFAULT_QUANTIZED),[p,v]=(0,u.useState)(e.DEFAULT_MULTILINGUAL),[y,w]=(0,u.useState)(e.DEFAULT_LANGUAGE),k=(0,u.useCallback)(()=>{r(void 0)},[]),j=(0,u.useCallback)(async e=>{if(e){let t;if(r(void 0),n(!0),2===e.numberOfChannels){let r=Math.sqrt(2),a=e.getChannelData(0),n=e.getChannelData(1);t=new Float32Array(a.length);for(let s=0;s<e.length;++s)t[s]=r*(a[s]+n[s])/2}else t=e.getChannelData(0);null==c||c.postMessage({audio:t,model:m,multilingual:p,quantized:h,subtask:p?x:null,language:p&&"auto"!==y?y:null})}},[c,m,p,h,x,y]);return(0,u.useMemo)(()=>({onInputChange:k,isBusy:a,isModelLoading:s,progressItems:l,start:j,output:t,model:m,setModel:g,multilingual:p,setMultilingual:v,quantized:h,setQuantized:b,subtask:x,setSubtask:f,language:y,setLanguage:w,resetWorker:d}),[a,s,l,j,t,m,p,h,x,y,d])}(),[n,i]=(0,u.useState)(14),[l,o]=(0,u.useState)("summary");return r&&null==t?(0,s.jsx)(s.Fragment,{}):(0,s.jsxs)("div",{className:"flex justify-start gap-5 px-5 py-8 ring-2 flex-grow h-full overflow-hidden items-start",children:[(0,s.jsx)(g,{feedItem:t}),(0,s.jsxs)(f,{value:l,className:"flex flex-col gap-1 items-start flex-grow bg-white p-5 rounded-lg h-full shadow-md",onValueChange:o,children:[(0,s.jsxs)("div",{className:"flex-none flex justify-between w-full items-center",children:[(0,s.jsxs)(h,{children:[(0,s.jsx)(b,{value:"summary",children:"介绍"}),(0,s.jsx)(b,{value:"transcribe",children:"字幕"})]}),(0,s.jsx)(p,{value:"summary",className:"mt-0",children:(0,s.jsx)(X,{value:n,onChange:i})}),(0,s.jsx)(p,{value:"transcribe",className:"mt-0",children:(0,s.jsx)(G,{transcriber:a})})]}),(0,s.jsx)(p,{value:"summary",className:(0,m.cn)("w-full h-full flex-grow overflow-hidden","summary"===l?void 0:"hidden"),children:(0,s.jsx)(v,{feedItem:t,fontSize:n})}),(0,s.jsx)(p,{value:"transcribe",className:(0,m.cn)("w-full flex flex-col flex-grow h-full overflow-hidden relative pb-8","transcribe"===l?void 0:"hidden"),children:(0,s.jsx)(I,{feedItem:t,transcriber:a})})]})]})}}},function(e){e.O(0,[545,611,715,847,755,117,915,986,271,146,672,744],function(){return e(e.s=6486)}),_N_E=e.O()}]);