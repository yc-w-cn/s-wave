(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[311],{8855:function(){},2977:function(t,e,n){Promise.resolve().then(n.bind(n,5883))},5818:function(t,e,n){"use strict";n.d(e,{j:function(){return d}});var a=n(8754),s=n(2779),r=n(1986),i=n(9077),o=n.n(i),c=n(3894),l=n.n(c),u=n(2123);function d(t){let{src:e,alt:n,...i}=t,[c,d]=(0,u.useState)(void 0);return(0,u.useEffect)(()=>((async()=>{if(e){let t=await (0,r.by)(e),n=o()().format("YYYYMMDD"),a="IMAGE_CACHE_".concat(t,"_").concat(n),i=await l().getItem(a);if(i)d(i);else try{let t=(0,s.X5)(e),n=await fetch(t),r=await n.blob(),i=new FileReader;i.readAsDataURL(r),i.onloadend=async()=>{let t=i.result;d(t),await l().setItem(a,t)}}catch(t){console.error("Error fetching image:",t)}}})(),()=>{}),[e]),(0,a.jsx)("img",{src:c||e,alt:n,...i})}},5883:function(t,e,n){"use strict";n.r(e),n.d(e,{PodcastPage:function(){return b}});var a=n(8754),s=n(2123),r=n(1986),i=n(5818),o=n(6847),c=n(7121);function l(t){let{feedContent:e}=t,n=(0,o.Qo)(),{toast:l}=(0,c.pm)(),[u,d]=(0,s.useState)(void 0),[f,p]=(0,s.useState)(void 0),[x,m]=(0,s.useState)(new Date().getTime());return(0,s.useEffect)(()=>{(async()=>{let t=e._id||await (0,r.by)(e.feedUrl);n.get(t).then(t=>{p(t),d(!0)}).catch(()=>d(!1))})()},[e,n,x]),(0,a.jsxs)("div",{className:(0,r.cn)("relative bg-white rounded-xl p-5 border overflow-hidden","flex flex-col justify-between items-center gap-5","max-w-[250px]"),children:[(0,a.jsx)(i.j,{src:e.itunes.image,alt:"Itunes Image",width:200,height:200,className:"flex-none rounded-lg"}),(0,a.jsxs)("div",{className:"flex flex-shrink flex-col items-start gap-3",children:[(0,a.jsx)("h3",{className:"text-lg font-bold",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-gray-700",children:e.description}),(0,a.jsx)("p",{className:" text-gray-500 text-sm",children:e.copyright})]}),void 0==u||!u&&(0,a.jsx)("button",{className:(0,r.cn)("text-pink-500 bg-pink-100 flex items-center px-4 gap-1 rounded-lg text-md py-1 font-semibold","outline outline-[1px] outline-pink-500","opacity-80 hover:opacity-100","transition-all duration-300"),onClick:async()=>{let t={_id:e._id||await (0,r.by)(e.feedUrl),...e};await n.put(t),l({title:"操作完成",description:"添加播客到订阅"}),m(new Date().getTime())},children:(0,a.jsx)("span",{children:"加入订阅"})}),u&&(0,a.jsx)("button",{className:(0,r.cn)("text-gray-500 flex items-center px-4 gap-1 rounded-lg text-md py-1 font-semibold","outline outline-[1px] outline-gray-500","hover:bg-gray-100 ","transition-all duration-300"),onClick:async()=>{await n.remove(f),l({title:"操作完成",description:"已取消订阅"}),m(new Date().getTime())},children:(0,a.jsx)("span",{children:"取消订阅"})})]})}var u=n(9077),d=n.n(u),f=n(8603);function p(t){var e;let{feedItem:n}=t,[i,o]=(0,s.useState)("undefined");return(0,s.useEffect)(()=>{(async()=>{n.guid&&o(await (0,r.by)(n.guid))})()},[n.guid]),(0,a.jsxs)(f.default,{href:"/item/?guid=".concat(i),className:"flex-none bg-white p-5 rounded-xl flex flex-col gap-3 items-start border overflow-hidden hover:border-pink-500",children:[(0,a.jsx)("span",{className:"text-sm bg-gray-100 px-2 rounded-lg text-gray-700",children:d()(n.isoDate).format("YYYY-MM-DD")}),(0,a.jsx)("h3",{className:"font-bold text-md",children:n.title}),(0,a.jsx)("div",{className:"text-ellipsis line-clamp-3 text-sm text-gray-700 w-full",children:n.content}),(0,a.jsx)("audio",{controls:!0,src:null===(e=n.enclosure)||void 0===e?void 0:e.url,className:"w-[280px]"})]})}var x=n(7981),m=n(3894),h=n.n(m);let g=async t=>t?h().getItem(t):null;var y=n(2779);async function w(t,e){let n=[];for(let t of e)n.push({_id:await (0,r.by)(t.guid),...t});return t.bulkDocs(n)}var v=n(4587);function b(){let t=(0,v.useSearchParams)().get("id"),e=(0,o.Qo)(),[n,i]=(0,s.useState)(),{data:c}=(0,x.ZP)("FEED_URL_".concat(t),g);return((0,s.useEffect)(()=>{c&&(0,y.DO)(c).then(t=>{i(t),w(e,t.items)})},[c,e,t]),n)?(0,a.jsxs)("div",{className:"w-full h-full flex gap-5",children:[(0,a.jsx)("div",{className:"flex-none pt-8",children:(0,a.jsx)(l,{feedContent:n})}),(0,a.jsx)("div",{className:(0,r.cn)("flex flex-col gap-5 pb-8 pt-8 pr-6 overflow-auto h-full","scrollbar scrollbar-thumb-gray-200 scrollbar-track-transparent"),children:n.items.map(t=>(0,a.jsx)(p,{feedItem:t},t.guid))})]}):(0,a.jsx)(a.Fragment,{})}},7121:function(t,e,n){"use strict";n.d(e,{pm:function(){return f}});var a=n(2123);let s=0,r=new Map,i=t=>{if(r.has(t))return;let e=setTimeout(()=>{r.delete(t),u({type:"REMOVE_TOAST",toastId:t})},1e6);r.set(t,e)},o=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,1)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(t=>t.id===e.toast.id?{...t,...e.toast}:t)};case"DISMISS_TOAST":{let{toastId:n}=e;return n?i(n):t.toasts.forEach(t=>{i(t.id)}),{...t,toasts:t.toasts.map(t=>t.id===n||void 0===n?{...t,open:!1}:t)}}case"REMOVE_TOAST":if(void 0===e.toastId)return{...t,toasts:[]};return{...t,toasts:t.toasts.filter(t=>t.id!==e.toastId)}}},c=[],l={toasts:[]};function u(t){l=o(l,t),c.forEach(t=>{t(l)})}function d(t){let{...e}=t,n=(s=(s+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>u({type:"DISMISS_TOAST",toastId:n});return u({type:"ADD_TOAST",toast:{...e,id:n,open:!0,onOpenChange:t=>{t||a()}}}),{id:n,dismiss:a,update:t=>u({type:"UPDATE_TOAST",toast:{...t,id:n}})}}function f(){let[t,e]=a.useState(l);return a.useEffect(()=>(c.push(e),()=>{let t=c.indexOf(e);t>-1&&c.splice(t,1)}),[t]),{...t,toast:d,dismiss:t=>u({type:"DISMISS_TOAST",toastId:t})}}},361:function(t,e,n){"use strict";function a(t){return"https://corsproxy.io/?"+encodeURIComponent(t)}function s(t){let e=encodeURIComponent(t);return"".concat("https://easy-cors-proxy.longzai.net.cn","/proxy?ACCESS_TOKEN=").concat("xyQNZeBJ0TpiRLYRNXQdb6BZCJLDajHM","&URL=").concat(e)}n.d(e,{X:function(){return s},x:function(){return a}})},2779:function(t,e,n){"use strict";n.d(e,{X5:function(){return a.X},DO:function(){return i},jI:function(){return u}});var a=n(361),s=n(6537),r=n.n(s);async function i(t){let e=new(r());return await e.parseURL((0,a.X)(t))}var o=n(7586),c=n(4599),l=n(9043);async function u(t){var e;return e=(await o.Z.post((0,a.x)("https://www.getrssfeed.com/"),l.Z.stringify({url:t}),{headers:{"Content-Type":"application/x-www-form-urlencoded"}})).data,c.zD(e)("#result-container > a").attr("href")}}},function(t){t.O(0,[611,715,934,603,847,48,986,146,672,744],function(){return t(t.s=2977)}),_N_E=t.O()}]);